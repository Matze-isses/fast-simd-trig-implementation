import matplotlib.pyplot as plt
import numpy as np

correction_values = [
    (0, 0.062500007059147489),
    (1, 0.066406256310472367),
    (2, 0.070312508620088865),
    (3, 0.074218749269001877),
    (4, 0.078124993480303648),
    (5, 0.082031245759342605),
    (6, 0.085937500216928572),
    (7, 0.089843745115936194),
    (8, 0.093749991622722337),
    (9, 0.097656243368730841),
    (10, 0.10156249360001111),
    (11, 0.10546875914338076),
    (12, 0.10937499970821778),
    (13, 0.11328125822416364),
    (14, 0.11718749079105407),
    (15, 0.12109374981285553),
    (16, 0.12500000600915642),
    (17, 0.12890624173616838),
    (18, 0.13281250593821872),
    (19, 0.13671875633229028),
    (20, 0.14062499132559148),
    (21, 0.14453125276561932),
    (22, 0.14843749918000254),
    (23, 0.15234374140082305),
    (24, 0.15625000129879432),
    (25, 0.16015624363194092),
    (26, 0.16406250906454695),
    (27, 0.16796874155587585),
    (28, 0.17187499445806242),
    (29, 0.17578124637080086),
    (30, 0.17968749886681873),
    (31, 0.18359375716791468),
    (32, 0.18749999209600676),
    (33, 0.19140625098295916),
    (34, 0.19531249420293290),
    (35, 0.19921875759425681),
    (36, 0.20312500431006120),
    (37, 0.20703124027229991),
    (38, 0.21093749771372980),
    (39, 0.21484375499543334),
    (40, 0.21875000802750039),
    (41, 0.22265624469947060),
    (42, 0.22656250277590337),
    (43, 0.23046875952841303),
    (44, 0.23437500965686170),
    (45, 0.23828124882417781),
    (46, 0.24218750594323674),
    (47, 0.24609375084738047),
    (48, 0.25000000563187108),
    (49, 0.25390625328993466),
    (50, 0.25781250482887791),
    (51, 0.26171875253969229),
    (52, 0.26562499199011930),
    (53, 0.26953125299046032),
    (54, 0.27343749905813403),
    (55, 0.27734374170618087),
    (56, 0.28124999906910375),
    (57, 0.28515624837874631),
    (58, 0.28906250523416838),
    (59, 0.29296875005025674),
    (60, 0.29687499638312670),
    (61, 0.30078124138828777),
    (62, 0.30468750623332957),
    (63, 0.30859375671411210),
    (64, 0.31249999648970300),
    (65, 0.31640625005028733),
    (66, 0.32031249599900596),
    (67, 0.32421874540608475),
    (68, 0.32812499249314137),
    (69, 0.33203125795705657),
    (70, 0.33593749239425674),
    (71, 0.33984375814595413),
    (72, 0.34375000929329141),
    (73, 0.34765625684439938),
    (74, 0.35156250287593382),
    (75, 0.35546874048600163),
    (76, 0.35937499265836254),
    (77, 0.36328124482395718),
    (78, 0.36718750213407486),
    (79, 0.37109375271897305),
    (80, 0.37500000492700020),
    (81, 0.37890624369175380),
    (82, 0.38281249614581375),
    (83, 0.38671874145106100),
    (84, 0.39062500276197815),
    (85, 0.39453125459466354),
    (86, 0.39843750383726351),
    (87, 0.40234375746624490),
    (88, 0.40625000183404375),
    (89, 0.41015624585428201),
    (90, 0.41406249556672320),
    (91, 0.41796874064442990),
    (92, 0.42187500468826467),
    (93, 0.42578125979504544),
    (94, 0.42968749122124228),
    (95, 0.43359375233173553),
    (96, 0.43750000006232620),
    (97, 0.44140624903369974),
    (98, 0.44531250886336826),
    (99, 0.44921874536003864),
    (100, 0.45312499750647989),
    (101, 0.45703124826504848),
    (102, 0.46093749469545153),
    (103, 0.46484374855427874),
    (104, 0.46875000916190868),
    (105, 0.47265624546375790),
    (106, 0.47656250954251134),
    (107, 0.48046875156319935),
    (108, 0.48437499940355627),
    (109, 0.48828124370402004),
    (110, 0.49218749446233628),
    (111, 0.49609374741929602),
    (112, 0.49999999653692839),
    (113, 0.50390624874468193),
    (114, 0.50781249792640082),
    (115, 0.51171875080191132),
    (116, 0.51562499511539561),
    (117, 0.51953125645658549),
    (118, 0.52343749834406961),
    (119, 0.52734374818889174),
    (120, 0.53125000556513102),
    (121, 0.53515625336198269),
    (122, 0.53906250897089569),
    (123, 0.54296875182662174),
    (124, 0.54687500453339621),
    (125, 0.55078124448098631),
    (126, 0.55468749549265917),
    (127, 0.55859374227380354),
    (128, 0.56249999365960546),
    (129, 0.56640625217952301),
    (130, 0.57031250923201593),
    (131, 0.57421874394992334),
    (132, 0.57812500778226827),
    (133, 0.58203125697155045),
    (134, 0.58593749005464901),
    (135, 0.58984374726630240),
    (136, 0.59374999725756561),
    (137, 0.59765624954636476),
    (138, 0.60156249895690750),
    (139, 0.60546875785008214),
    (140, 0.60937499393612182),
    (141, 0.61328124946768381),
    (142, 0.61718750852241788),
    (143, 0.62109375737644246),
    (144, 0.62500000960457236),
    (145, 0.62890625860732696),
    (146, 0.63281250039144399),
    (147, 0.63671875596921523),
    (148, 0.64062500558900004),
    (149, 0.64453125998225869),
    (150, 0.64843750894990781),
    (151, 0.65234375265120204),
    (152, 0.65624999923190441),
    (153, 0.66015625086512608),
    (154, 0.66406250710989612),
    (155, 0.66796874423728669),
    (156, 0.67187500594958505),
    (157, 0.67578124269870599),
    (158, 0.67968749159500652),
    (159, 0.68359375010039258),
    (160, 0.68750000547024070),
    (161, 0.69140624761372860),
    (162, 0.69531250177379955),
    (163, 0.69921874742985191),
    (164, 0.70312500713206982),
    (165, 0.70703124015175012),
    (166, 0.71093749387635896),
    (167, 0.71484374317542632),
    (168, 0.71874999312375176),
    (169, 0.72265625056458871),
    (170, 0.72656249270450124),
    (171, 0.73046875856204030),
    (172, 0.73437499835808384),
    (173, 0.73828125400781208),
    (174, 0.74218750431207536),
    (175, 0.74609375840350878),
    (176, 0.75000000376167697),
    (177, 0.75390624250269600),
    (178, 0.75781250425562907),
    (179, 0.76171875237018127),
    (180, 0.76562500400318989),
    (181, 0.76953125814521162),
    (182, 0.77343749958182595),
    (183, 0.77734374538899753),
    (184, 0.78124999684567953),
    (185, 0.78515625783726140),
    (186, -0.0000000000000000),
    (187, 10680707.000000000),
    (188, 16069853.000000000),
    (189, 16666979.000000000),
    (190, 4345298.0000000000),
    (191, 16653803.000000000),
    (192, 3062596.0000000000),
    (193, 3772886.0000000000),
    (194, 12450088.000000000),
    (195, 15675153.000000000),
    (196, 2607881.0000000000),
    (197, 7677882.0000000000),
    (198, 9065106.0000000000),
    (199, 5636912.0000000000),
    (200, 10155062.000000000),
]

e0 = 0.3333333333332254
e1 = 0.13333354920669913


def get_correction(w):
    i = ((int) (-15.5 + 256 * w))
    return correction_values[i][1]


def get_z_from_w(w):
    return w - get_correction(w)


input_range = np.linspace(0.0608, np.pi/4, 1000)
res = []

for v in input_range:
    z = get_z_from_w(v)
    pz = z + z**3 * (e0 + z**2 * e1)
    res.append(pz)

np.array(res)

# plt.scatter(input_range, res, label="z values", s=0.5)
plt.plot(input_range, res, label="pz", lw=1)
plt.xlabel("Tan Input")
plt.ylabel("pz")
plt.legend()
plt.savefig("../plots/glibc/pz.png")
plt.show()

